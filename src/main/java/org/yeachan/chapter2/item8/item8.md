# finalizer와 cleaner 사용을 피하라
자바의 객체 소멸자에는 두가지가 존재한다
- finalizer: 예측 불가능하고, 위험하며, 대부분 불필요하다. 성능도 문제있고(finalizer 내부의 로직을 수행하기 때문) 이식성에도 문제를 일으킨다.
    - 딱 두가지 경우에는 사용하는데
        - 안전망 역할로 자원을 반납하고자 하는 경우
        - 네이티브 리소스를 정리해야 하는 경우
    - 자바 9에서는 finalizer가 deprecated 됐다고 한다
- cleaner

단점을 정리해보자면
1. 언제 실행될지 알 수 없다
2. 특히 finalizer 같은 경우에는 실행 자체가 안될 수도 있다
    객체 사용이 끝나고 나서 프로세스가 종료될 때 까지도 GC가 finalizer를 호출이 늦을 수 있다
    소멸자는 호출 우선순위가 높지 않다는점을 인지하자
3. 늦는건 고사하고 그냥 소멸자 실행을 안할 수 있다
    `System.gc` 에 현혹되지 마라. 바로 실행되는게 아니다.
4. finalizer 자체가 try-with-resource로 자원 반납하는거보다 성능이 안좋다고 한다
5. 보안 이슈도
    자식 클래스에서 자식 객체를 생성할 때 예외를 던진다 하자
    이 때 finalizer를 오버라이딩 했다 하자
    객체가 소멸될 때 그냥 죽어야하는데 finalizer가 실행된다
    이렇게 되면 finalizer 안에서 해당 인스턴스 내부에서 부모 클래스의 static 필드에 접근이 가능해져버린다(세상에나)
    그래서 부모에서 finalizer를 final 메서드로 만들어서 이를 방지하는 방법도 있다고 한다

그럼 어떻게 자원을 반납할 것이냐
- try-with-resource
- try-finally로 명시적으로 close 하는것도 좋다
- 반납 후에 close가 호출됐다면 예외 던지기
- 안전망 삼아 AutoCloseable을 믿지 말고 finalizer에 close를 넣어주자


네이티브 객체를 자바의 클레스가 쓰는 경우에는 GC가 그걸 모른다

그래서 성능에 큰 영향을 주는 네이티브 객체는 close를 사용하는것이 좋다